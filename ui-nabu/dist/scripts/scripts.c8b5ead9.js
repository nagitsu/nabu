!function(){"use strict";angular.module("nabuApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","ui.router","ui.bootstrap","md.data.table","restangular","ui.ace","chart.js"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/dashboard"),a.state("initial",{"abstract":!0,templateUrl:"views/main.html"}).state("initial.tabs",{"abstract":!0,templateUrl:"views/tabs.html",controller:"TabsCtrl"}).state("initial.tabs.corpus",{url:"/corpus",views:{corpusSearch:{templateUrl:"views/corpus-search.html",controller:"CorpusCtrl",resolve:{sourceList:["Corpus",function(a){return a.stats().then(function(a){var b=[];return _.each(a.data.by_source,function(a){b.push(a.source)}),b})}]}}},params:{esQuery:null}}).state("initial.tabs.dashboard",{url:"/dashboard",views:{dashboard:{templateUrl:"views/dashboard.html",controller:"DashboardCtrl",resolve:{corpusStats:["Corpus",function(a){return a.stats().then(function(a){return a.data})}]}}}}).state("initial.tabs.embeddings",{url:"/embeddings",views:{embeddings:{templateUrl:"views/embeddings.html",controller:"EmbeddingsCtrl",resolve:{embeddingList:["Embeddings",function(a){return a.list().then(function(a){return a.data})}]}}},params:{newEmbQuery:null}}).state("initial.tabs.embeddings-detail",{url:"/embeddings/:embeddingId",views:{"embedding-detail":{templateUrl:"views/embedding-detail.html",controller:"EmbeddingDetailCtrl",resolve:{embedding:["Embeddings","$stateParams",function(a,b){return a.retrieve(b.embeddingId).then(function(a){return a.data})}],evaluationResults:["Results","$stateParams",function(a,b){return a.list(b.embeddingId).then(function(a){return a.data})}],testList:["TestSets",function(a){return a.list().then(function(a){return a.data})}]}}}}).state("initial.tabs.tests",{url:"/tests",views:{tests:{templateUrl:"views/tests.html",controller:"TestsCtrl",resolve:{testsList:["TestSets",function(a){return a.list().then(function(a){return a.data})}]}}}}).state("initial.tabs.tests-detail",{url:"/tests/:testId",views:{"test-detail":{templateUrl:"views/test-detail.html",controller:"TestDetailCtrl",resolve:{testset:["TestSets","$stateParams",function(a,b){return a.retrieve(b.testId).then(function(a){return a.data})}],evaluationResults:["Results","$stateParams",function(a,b){return a.list(null,b.testId).then(function(a){return a.data})}],embeddingList:["Embeddings",function(a){return a.list().then(function(a){return a.data})}]}}}})}]).config(["$mdThemingProvider",function(a){a.theme("default")}]).run(["Restangular",function(a){a.setBaseUrl("http://golbat.ydns.eu/api"),a.setRequestSuffix("/")}])}(angular,_),angular.module("nabuApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("nabuApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),function(){"use strict";angular.module("nabuApp").controller("TabsCtrl",["$rootScope","$scope","$state",function(a,b,c){b.tabs=["dashboard","corpus","embeddings","tests"],b.changeTab=function(a){var b="initial.tabs."+a;c.go(b)},b.setCurrentTab=function(a){var c=a.name.match(/tabs\.(\w+)(\.|$|-)/);b.selectedIndex=b.tabs.indexOf(c[1])},a.$on("$stateChangeStart",function(a,c,d,e,f){b.setCurrentTab(c)}),b.setCurrentTab(c.current)}])}(angular),function(){"use strict";angular.module("nabuApp").controller("CorpusCtrl",["$stateParams","$scope","$mdDialog","Corpus","sourceList",function(a,b,c,d,e){if(b.resultsTable={page:1,limit:25},b.loading=!1,b.dialogLoading=!1,b.useAdvancedQuery=!1,b.sourceList=e,b.searchQuery={query:"",sources:[]},b.basicQuery={query:{match:{content:""}}},b.filterSourceQuery={query:{filtered:{filter:{terms:{data_source:[]}},query:{match:{content:""}}}}},b.advancedQuery=angular.toJson(b.basicQuery,!0),a.esQuery){var f=angular.fromJson(a.esQuery);b.advancedQuery=angular.toJson({query:f},!0),b.useAdvancedQuery=!0}b.buildQuery=function(){var a;return b.useAdvancedQuery?a=angular.fromJson(b.advancedQuery):b.searchQuery.sources.length?(a=b.filterSourceQuery,a.query.filtered.query.match.content=b.searchQuery.query,a.query.filtered.filter.terms.data_source=b.searchQuery.sources):(a=b.basicQuery,a.query.match.content=b.searchQuery.query),a},b.$watch("searchQuery",function(){var a=b.buildQuery();b.advancedQuery=angular.toJson(a,!0)},!0),b.search=function(){b.loading=!0;var a=b.buildQuery();d.search(a).then(function(a){b.resultsTable.page=1,b.results=a,b.loading=!1})},b.onPaginationChange=function(a,c){var e=b.buildQuery(),f=(a-1)*b.resultsTable.limit;return d.search(e,f).then(function(a){b.results=a})},b.onOrderChange=function(a){return null},b.aceLoaded=function(a){a.$blockScrolling=1/0},b.documentDetailDialog=function(a,d){b.dialogLoading||(b.dialogLoading=!0,c.show({controller:"DocumentDetailDialogCtrl",templateUrl:"views/document-detail.html",targetEvent:a,clickOutsideToClose:!0,resolve:{docData:["Corpus",function(a){return a.documentRetrieve(d)}]},onComplete:function(){b.dialogLoading=!1}}))}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("DocumentDetailDialogCtrl",["$scope","$mdDialog","docData",function(a,b,c){a.corpusDoc=c.data,a.cancel=function(){b.cancel()}}])}(angular),function(){"use strict";angular.module("nabuApp").factory("Corpus",["Restangular",function(a){return{search:function(b,c){return c||(c=0),a.all("corpus").all("search").post(b,{offset:c})},stats:function(){return a.all("corpus").one("stats").get()},documentRetrieve:function(b){return a.all("corpus").one("document",b).get()},enums:function(){return a.all("corpus").one("enums").get()}}}])}(angular),function(){"use strict";angular.module("nabuApp").factory("Embeddings",["Restangular",function(a){return{list:function(){return a.one("embeddings").get()},create:function(b){return a.all("embeddings").post(b)},retrieve:function(b){return a.one("embeddings",b).get()},update:function(b,c){return a.one("embeddings",b).post("",c)},"delete":function(b){return a.one("embeddings",b).remove()}}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("EmbeddingsCtrl",["$stateParams","$timeout","$scope","$mdDialog","Enums","Embeddings","embeddingList",function(a,b,c,d,e,f,g){c.dialogLoading=!1,c.embeddings=g,c.newEmbeddingDialog=function(b){c.dialogLoading||(c.dialogLoading=!0,d.show({controller:"EmbeddingNewDialogCtrl",templateUrl:"views/embedding-new.html",targetEvent:b,clickOutsideToClose:!0,resolve:{modelEnums:["Enums",function(a){return a.models()}],corpusEnums:["Enums",function(a){return a.corpus()}]},locals:{Embeddings:f,newEmbQuery:a.newEmbQuery},onComplete:function(){c.dialogLoading=!1}}).then(function(a){a&&f.list().then(function(a){c.embeddings=a.data})}))},a.newEmbQuery&&b(function(){angular.element("#new-embedding-btn").trigger("click")},100)}])}(angular),function(){"use strict";angular.module("nabuApp").filter("titlecase",function(){return function(a){for(var b=a.split(" "),c=0;c<b.length;c++)b[c]=b[c].toLowerCase(),b[c]=b[c].charAt(0).toUpperCase()+b[c].slice(1);return b.join(" ")}})}(angular),function(){"use strict";angular.module("nabuApp").controller("EmbeddingNewDialogCtrl",["$scope","$mdDialog","Embeddings","modelEnums","corpusEnums","newEmbQuery",function(a,b,c,d,e,f){a.showErrors=!1,a.models=_.fromPairs(_.map(d.data,function(a){return[a.model,a]})),a.corpusPreprocessors=e.data,a.newEmb={model:d.data[0].model,description:"",parameters:{},preprocessing:{},query:{}},a.currentParams=[],a.$watch("newEmb.model",function(){a.newEmb.parameters={},a.currentParams=a.models[a.newEmb.model].parameters,angular.forEach(a.currentParams,function(b){a.newEmb.parameters[b.name]=b["default"]})}),a.$watch("searchQuery",function(){a.newEmb.query=angular.fromJson(a.searchQuery)}),f?a.searchQuery=angular.toJson(f,!0):a.searchQuery=angular.toJson({match:{content:""}},!0),a.aceLoaded=function(a){a.$blockScrolling=1/0},a.create=function(){a.showErrors=!1,c.create(a.newEmb).then(function(a){b.hide(!0)},function(){a.showErrors=!0})},a.cancel=function(){b.cancel()}}])}(angular,_),function(){"use strict";angular.module("nabuApp").service("Enums",["Restangular",function(a){return{models:function(){return a.all("enums").one("models").get()},corpus:function(){return a.all("enums").one("corpus").get()}}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("EmbeddingDetailCtrl",["$scope","$state","VerifyDelete","JobsTraining","Embeddings","embedding","evaluationResults","testList",function(a,b,c,d,e,f,g,h){a.embedding=f,a.evaluationResults=g,a.testSet=_.fromPairs(_.map(h,function(a){return[a.id,a]})),a.searchQuery=angular.toJson(a.embedding.corpus.query,!0),a.aceLoaded=function(a){a.setReadOnly(!0),a.$blockScrolling=1/0},a.trainEmbedding=function(){var b={embedding_id:a.embedding.id};d.create(b).then(function(){console.log("Embedding marked for training."),e.retrieve(a.embedding.id).then(function(b){a.embedding=b.data})})},a.updateEmbedding=function(){var b={description:a.embedding.description};e.update(a.embedding.id,b).then(function(b){a.embedding=b.data})},a.deleteEmbedding=function(){var d="Are you sure you want to delete this embedding?";new c(d,"Embedding").then(function(){e["delete"](a.embedding.id).then(function(){b.go("initial.tabs.embeddings")})})}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("TestsCtrl",["$scope","$mdDialog","TestSets","testsList",function(a,b,c,d){a.dialogLoading=!1,a.tests=d,a.newTestSetDialog=function(d){a.dialogLoading||(a.dialogLoading=!0,b.show({controller:"TestNewDialogCtrl",templateUrl:"views/test-new.html",targetEvent:d,clickOutsideToClose:!0,locals:{TestSets:c},onComplete:function(){a.dialogLoading=!1}}).then(function(b){b&&c.list().then(function(b){a.tests=b.data})}))}}])}(angular),function(){"use strict";angular.module("nabuApp").service("TestSets",["Restangular",function(a){return{list:function(){return a.one("testsets").get()},create:function(b){var c=new FormData;return c.append("name",b.name),c.append("type",b.type),c.append("file",b.file),c.append("description",b.description),a.all("testsets").withHttpConfig({transformRequest:angular.identity}).customPOST(c,"",void 0,{"Content-Type":void 0})},retrieve:function(b){return a.one("testsets",b).get()},update:function(b,c){return a.one("testsets",b).post("",c)},"delete":function(b){return a.one("testsets",b).remove()}}}])}(angular),function(){"use strict";angular.module("nabuApp").service("VerifyDelete",["$mdDialog",function(a){return function(b,c){var d=c||"Object",e=a.confirm().title("Please confirm the action").content(b).ariaLabel("Delete "+d).ok("Confirm").cancel("Cancel");return a.show(e)}}])}(angular),function(){"use strict";angular.module("nabuApp").factory("JobsTraining",["Restangular",function(a){return{list:function(){return a.all("jobs").one("training").get()},create:function(b){return a.all("jobs").all("training").post(b)},retrieve:function(b){return a.all("jobs").one("training",b).get()},"delete":function(b){return a.all("jobs").one("training",b).remove()}}}])}(angular),function(){"use strict";angular.module("nabuApp").service("Results",["Restangular",function(a){return{list:function(b,c){var d={};return b&&(d.embedding=b),c&&(d.testset=c),a.one("results").get(d)},retrieve:function(b,c){return a.one("results",b).one("",c).get()},"delete":function(b,c){return a.one("results",b).one("",c).remove()}}}])}(angular),function(){"use strict";angular.module("nabuApp").filter("percentage",["$filter",function(a){return function(b,c){return c||(c=0),a("number")(100*b,c)+"%"}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("TestNewDialogCtrl",["$scope","$mdDialog","TestSets",function(a,b,c){a.showErrors=!1,a.uploadFileName="Please select a test set file.",a.uploadFile=function(b){a.uploadFileName=b.target.files[0].name,a.newTestSet.file=b.target.files[0]},a.newTestSet={name:"",description:"",type:"",file:""},a.create=function(){a.showErrors=!1,c.create(a.newTestSet).then(function(a){b.hide(!0)},function(){a.showErrors=!0})},a.cancel=function(){b.cancel()}}])}(angular),function(){"use strict";angular.module("nabuApp").directive("chooseFileButton",function(){return{link:function(a,b,c){var d=b.find("button"),e=b.find("input");e.css({display:"none"}),d.bind("click",function(){e[0].click()});var f=a.$eval(c.chooseFileButton);b.bind("change",f)}}})}(angular),function(){"use strict";angular.module("nabuApp").controller("TestDetailCtrl",["$scope","$state","$mdDialog","VerifyDelete","TestSets","Results","testset","evaluationResults","embeddingList",function(a,b,c,d,e,f,g,h,i){a.dialogLoading=!1,a.testSet=g,a.evaluationResults=h,a.embeddings=_.fromPairs(_.map(i,function(a){return[a.id,a]})),a.updateTestSet=function(){var b={name:a.testSet.name,description:a.testSet.description};e.update(a.testSet.id,b).then(function(b){a.testSet=b.data})},a.deleteTestSet=function(){var c="Are you sure you want to delete this test set?";new d(c,"Test Set").then(function(){e["delete"](a.testSet.id).then(function(){b.go("initial.tabs.tests")})})},a.testResultDialog=function(b,d){a.dialogLoading||(a.dialogLoading=!0,c.show({controller:"TestResultDialogCtrl",templateUrl:"views/test-result-dialog.html",targetEvent:b,clickOutsideToClose:!0,resolve:{resultData:["Results",function(b){return b.retrieve(d,a.testSet.id).then(function(a){return a.data})}]},locals:{embedding:a.embeddings[d],test:a.testSet},onComplete:function(){a.dialogLoading=!1}}))},a.newEmbeddingTestDialog=function(b){a.dialogLoading||(a.dialogLoading=!0,c.show({controller:"NewEmbeddingTestDialogCtrl",templateUrl:"views/test-embedding-new.html",targetEvent:b,clickOutsideToClose:!0,locals:{embeddings:i,test:a.testSet},onComplete:function(){a.dialogLoading=!1}}))}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("TestResultDialogCtrl",["$scope","$mdDialog","resultData","embedding","test",function(a,b,c,d,e){a.resultData=c,a.embedding=d,a.test=e,a.cancel=function(){b.cancel()}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("NewEmbeddingTestDialogCtrl",["$scope","$mdDialog","JobsTesting","embeddings","test",function(a,b,c,d,e){a.embeddings=d,a.test=e,a.newTest={embeddingId:a.embeddings[0].id},a.create=function(){a.showErrors=!1,c.create(a.newTest.embeddingId,a.test.id).then(function(a){b.hide(!0)},function(){a.showErrors=!0})},a.cancel=function(){b.cancel()}}])}(angular),function(){"use strict";angular.module("nabuApp").factory("JobsTesting",["Restangular",function(a){return{list:function(){return a.all("jobs").one("testing").get()},create:function(b,c){var d={embedding_id:b,testset_id:c};return a.all("jobs").all("testing").post(d)},retrieve:function(b){return a.all("jobs").one("testing",b).get()},"delete":function(b){return a.all("jobs").one("testing",b).remove()}}}])}(angular),function(){"use strict";angular.module("nabuApp").controller("DashboardCtrl",["$interval","$scope","$mdToast","Corpus","corpusStats",function(a,b,c,d,e){function f(a){var b={};return _.forEach(a.by_source,function(a){b[a.source]={},b[a.source].size=a.size}),_.forEach(a.over_time,function(a){b[a.source].over_time=[a.values]}),b}function g(a,b,c){var d=[],e=moment(b),f=b.diff(a,"days");if(a.isValid()&&b.isValid()&&!(0>=f)){for(var g=0;f>g;g++)d.push(e.subtract(1,"d").format(c));return _.reverse(d)}}b.corpusStats=f(e),b.corpusSize=e.size,b.corpusGraphSeries=["Scraped items"],b.corpusGraphLabels=g(moment().subtract(10,"days"),moment().add(1,"days"),"DD/MM"),b.corpusTimer=a(function(){d.stats().then(function(a){var d=b.corpusSize;b.corpusStats=f(a.data),b.corpusSize=a.data.size;var e=b.corpusSize-d;e>0&&c.show(c.simple({hideDelay:5e3,position:"bottom right"}).content("We just got "+e+" new words!"))})},1e4)}])}(angular,moment),angular.module("nabuApp").run(["$templateCache",function(a){"use strict";a.put("views/corpus-search.html",'<div class="tab-container"> <form flex name="search-form"> <div layout="column"> <div layout="row" collapse="useAdvancedQuery"> <div flex="5" layout="row" layout-align="center center"> <i class="fa fa-search fa-2x"></i> </div> <md-input-container flex="30"> <label>Search</label> <input type="text" required ng-model="searchQuery.query"> </md-input-container> <md-input-container flex="25"> <label>Filter source</label> <md-select ng-model="searchQuery.sources" multiple> <md-option ng-repeat="source in sourceList" value="{{source}}">{{source}}</md-option> </md-select> </md-input-container> </div> <div layout="row" layout-sm="column" layout-wrap collapse="!useAdvancedQuery"> <md-input-container class="md-block es-query-box-block" flex="40" flex-sm="80"> <span class="md-label-sim">Elasticsearch query <div class="es-query-box" ng-model="advancedQuery" ui-ace="{\n              useWrapMode : true,\n              showGutter: true,\n              mode: \'json\',\n              onLoad: aceLoaded,\n              onChange: aceChanged\n            }"> </div> </span></md-input-container> </div> <div layout="row"> <md-switch ng-model="useAdvancedQuery" aria-label="Use advanced query"> Use advanced query </md-switch> </div> <div layout="row"> <md-input-container flex="15"> <md-button class="md-raised corpus-search-btn md-primary md-hue-4" ng-click="search()"> SEARCH </md-button> </md-input-container> <span flex></span> </div> </div> </form> <div ng-show="results.data.hits.length > 0 && !loading"> <md-data-table-toolbar> <h2 class="md-title">Results</h2> <span flex></span> <md-fab-speed-dial md-direction="left" class="md-scale"> <md-fab-trigger> <md-button aria-label="menu" class="md-fab"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-bars"></md-icon> </md-button> </md-fab-trigger> <md-fab-actions> <md-button class="md-fab md-mini" aria-label="Embedding from query" ui-sref="initial.tabs.embeddings({newEmbQuery: buildQuery()})"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-magic"></md-icon> <md-tooltip md-direction="top">Embedding From Query</md-tooltip> </md-button> <md-button class="md-fab md-mini" aria-label="Download corpus" href="{{results.data.download_link}}" download> <md-icon class="fab-btn-icon" md-font-icon="fa fa-download"></md-icon> <md-tooltip md-direction="top">Download Corpus</md-tooltip> </md-button> </md-fab-actions> </md-fab-speed-dial> </md-data-table-toolbar> <md-data-table-container> <table md-data-table md-progress="deferred" class="corpus-search-results"> <thead md-order="resultsTable.order" md-trigger="onOrderChange"> <tr> <th name="Date Scraped" order-by="date_scraped"></th> <th name="Snippet" order-by="snippet"></th> <th name="Source" order-by="source"></th> </tr> </thead> <tbody> <tr md-auto-select ng-repeat="result in results.data.hits" ng-click="documentDetailDialog($event, result.document_id)"> <td>{{result.date_scraped | date:\'dd/MM/yyyy\'}}</td> <td ng-bind-html="result.snippet"></td> <td>{{result.source}}</td> </tr> </tbody> </table> </md-data-table-container> <md-data-table-pagination md-limit="resultsTable.limit" md-page="resultsTable.page" md-total="{{results.meta.count}}" md-trigger="onPaginationChange" md-row-select="[resultsTable.limit]"> </md-data-table-pagination> </div> <div ng-if="loading" layout="row" layout-align="center center"> <md-progress-circular md-mode="indeterminate"></md-progress-circular> </div> <div ng-if="results.data.hits.length == 0 && !loading" layout="row"> <div layout="column" layout-align="start center"> <h2 class="md-title no-results">No results</h2> </div> </div> </div>'),a.put("views/dashboard.html",'<div layout-padding class="tab-container"> <div layout-padding layout="row"> <h3> The corpus currently has <span style="color: #FF4081">{{corpusSize | number}}</span> words! </h3> </div> <div layout="row" layout-align="center center" layout-wrap> <md-card class="nabu-card" ng-repeat="(corpusSource, sourceData) in corpusStats"> <md-card-content> <div class="md-title" layout="row" layout-wrap> <p>{{corpusSource}}</p> </div> <p>Size: {{sourceData.size | number}}</p> <div flex layout="row"> <canvas id="{{corpusSource}}-bar" class="chart chart-bar" chart-data="sourceData.over_time" chart-labels="corpusGraphLabels" chart-series="corpusGraphSeries" chart-colours="[\'#3F51B5\', \'#FF4081\']"> </canvas> </div> </md-card-content> </md-card> </div> </div>'),a.put("views/document-detail.html",'<md-dialog class="doc-detail-dialog" aria-label="{{corpusDoc.metadata.title}}" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>{{corpusDoc.metadata.title}}</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <i aria-label="Close" class="fa fa-close"></i> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="row"> <div flex> <h5>Source: <i>{{corpusDoc.data_source}}</i></h5> <h5 ng-show="corpusDoc.tags.length">Tags: <i>{{corpusDoc.tags.join(\', \')}}</i></h5> <h5>Word count: <i>{{corpusDoc.word_count}}</i></h5> </div> <div flex> <h5 ng-show="corpusDoc.metadata.date"> Date: <i>{{corpusDoc.metadata.date | date:\'dd/MM/yyyy\'}}</i> </h5> <h5>Date scraped: <i>{{corpusDoc.date_scraped | date:\'dd/MM/yyyy\'}}</i></h5> </div> </div> <md-divider></md-divider> <span class="doc-content">{{corpusDoc.content}}</span> </div> </md-dialog-content> <div class="md-actions" layout="row"> <md-button href="{{corpusDoc.permalink}}" target="_blank" md-autofocus> View source </md-button> </div> </md-dialog>'),a.put("views/embedding-detail.html",'<div layout-padding class="tab-container"> <div layout-padding layout="row"> <div layout="column"> <small class="section-header"> <a ui-sref="initial.tabs.embeddings">Embeddings</a> > <b>Embedding #{{embedding.id}}</b> </small> <div layout="row" class="emb-detail-name"> <div ng-class="embedding.status | lowercase" class="status"> <md-tooltip md-direction="bottom">{{embedding.status | titlecase}}</md-tooltip> </div> <p>{{embedding.name}}</p> </div> </div> <span flex></span> <md-fab-speed-dial md-direction="left" class="md-scale"> <md-fab-trigger> <md-button aria-label="menu" class="md-fab"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-bars"></md-icon> </md-button> </md-fab-trigger> <md-fab-actions> <md-button class="md-fab md-mini" aria-label="Download embedding" href="{{embedding.download_link}}" download> <md-icon class="fab-btn-icon" md-font-icon="fa fa-download"></md-icon> <md-tooltip md-direction="top">Download Embedding</md-tooltip> </md-button> <md-button class="md-fab md-mini" aria-label="Train embedding" ng-click="trainEmbedding()"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-lightbulb-o"></md-icon> <md-tooltip md-direction="top">Train Embedding</md-tooltip> </md-button> <md-button class="md-fab md-mini" aria-label="Delete embedding" ng-click="deleteEmbedding()"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-trash-o"></md-icon> <md-tooltip md-direction="top">Delete Embedding</md-tooltip> </md-button> </md-fab-actions> </md-fab-speed-dial> </div> <div layout-padding layout="row" layout-sm="column"> <md-input-container flex="40" flex-sm="90"> <label>Description</label> <textarea ng-blur="updateEmbedding()" ng-model="embedding.description" columns="1"></textarea> </md-input-container> <span flex="15"></span> <md-input-container flex="40" flex-sm="90"> <label>Corpus Size</label> <textarea ng-readonly="true" columns="1">{{embedding.corpus.size | number}}</textarea> </md-input-container> </div> <div layout-padding layout="row" layout-sm="column"> <md-data-table-container flex="40" flex-sm="90"> <span layout-padding class="md-label-sim">Model Parameters</span> <table layout-padding md-data-table md-progress="deferred" class="corpus-search-results"> <thead md-order="parametersTable.order" md-trigger="onOrderChange"> <tr> <th name="Parameter" order-by="parameter"></th> <th name="Value" order-by="value"></th> </tr> </thead> <tbody> <tr md-auto-select ng-repeat="(prop, value) in embedding.parameters"> <td>{{prop}}</td> <td>{{value || \'--\'}}</td> </tr> </tbody> </table> </md-data-table-container> <span flex="15" class="emb-separator"> <div class="vertical-separator"></div> </span> <div layout="column" flex="40" flex-sm="90"> <md-data-table-container flex> <span layout-padding class="md-label-sim">Corpus Preprocessing</span> <table layout-padding md-data-table md-progress="deferred" class="corpus-search-results"> <thead md-order="preprocessingTable.order" md-trigger="onOrderChange"> <tr> <th name="Parameter" order-by="parameter"></th> <th name="Value" order-by="value"></th> </tr> </thead> <tbody> <tr md-auto-select ng-repeat="(prop, value) in embedding.corpus.preprocessing"> <td>{{prop}}</td> <td>{{value || \'--\'}}</td> </tr> </tbody> </table> </md-data-table-container> <md-input-container class="md-block" flex> <div layout="row"> <span class="md-label-sim">Elasticsearch query</span> <span flex></span> <span class="text-right"> <a ui-sref="initial.tabs.corpus({esQuery: searchQuery})">Run query</a> </span> </div> <div class="es-query-box" ng-model="searchQuery" ui-ace="{\n            useWrapMode: true,\n            showGutter: true,\n            mode: \'json\',\n            onLoad: aceLoaded,\n            onChange: aceChanged\n          }"> </div> </md-input-container> </div> </div> <div ng-show="evaluationResults.length > 0" layout="row" flex> <md-data-table-container flex> <span layout-padding class="md-label-sim">Evaluation</span> <table layout-padding md-data-table md-progress="deferred" class="corpus-search-results"> <thead md-order="evaluation.order" md-trigger="onOrderChange"> <tr> <th name="Date" order-by="creation_date"></th> <th name="Name"></th> <th name="Description"></th> <th name="Accuracy" order-by="accuracy"></th> </tr> </thead> <tbody> <tr md-auto-select ng-repeat="result in evaluationResults | orderBy: evaluation.order"> <td>{{result.creation_date}}</td> <td> <a ui-sref="initial.tabs.tests-detail({testId: result.testset_id})"> {{testSet[result.testset_id].name}} </a> </td> <td>{{testSet[result.testset_id].description}}</td> <td>{{result.accuracy | percentage}}</td> </tr> </tbody> </table> </md-data-table-container> </div> </div>'),a.put("views/embedding-new.html",'<md-dialog flex="85" class="nabu-dialog" aria-label="Create new embedding" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>Create new embedding</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <i aria-label="Close" class="fa fa-close"></i> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <form name="newEmbeddingForm"> <div layout="row" layout-sm="column"> <md-input-container flex="20" flex-sm="100"> <label>Model</label> <md-select ng-model="newEmb.model"> <md-option ng-repeat="model in models" value="{{model.model}}"> {{model.verbose_name}} </md-option> </md-select> </md-input-container> <md-input-container flex="80" flex-sm="100"> <label>Description</label> <textarea ng-model="newEmb.description" columns="1"></textarea> </md-input-container> </div> <h5>Model parameters</h5> <div layout="row" layout-sm="column" layout-wrap> <md-input-container class="md-block" flex="50" flex-sm="100" ng-repeat="param in currentParams"> <div ng-if="param.type == \'bool\'"> <span class="md-label-sim">{{param.verbose_name}}</span> <md-switch ng-model="newEmb.parameters[param.name]" aria-label="{{param.description}}" layout-align="start end"> </md-switch> </div> <label ng-if="param.type != \'bool\'">{{param.verbose_name}}</label> <input ng-if="param.type == \'str\'" ng-model="newEmb.parameters[param.name]"> <input ng-if="param.type == \'float\' || param.type == \'int\'" type="number" ng-model="newEmb.parameters[param.name]"> <md-select ng-if="param.type == \'options\'" ng-model="newEmb.parameters[param.name]"> <md-option ng-repeat="opt in param.values" value="{{opt.name}}"> {{opt.verbose_name}} </md-option> </md-select> <md-tooltip md-direction="top">{{param.description}}</md-tooltip> </md-input-container> </div> <h5>Query</h5> <div layout="row" layout-sm="column" layout-wrap> <md-input-container class="md-block" flex="50" flex-sm="100"> <span class="md-label-sim">Elasticsearch query</span> <div class="es-query-box" ng-model="searchQuery" ui-ace="{\n                  useWrapMode : true,\n                  showGutter: true,\n                  mode: \'json\',\n                  onLoad: aceLoaded,\n                  onChange: aceChanged\n                }"> </div> </md-input-container> </div> <h5>Preprocessing</h5> <div layout="row" layout-sm="column" layout-wrap> <md-input-container class="md-block" flex="50" flex-sm="100" ng-repeat="prep in corpusPreprocessors"> <div ng-if="prep.type == \'bool\'"> <span class="md-label-sim">{{prep.verbose_name}}</span> <md-switch ng-model="newEmb.preprocessing[prep.name]" aria-label="{{prep.description}}" layout-align="start end" ng-init="newEmb.preprocessing[prep.name] = prep.default"> </md-switch> </div> <label ng-if="prep.type != \'bool\'">{{prep.verbose_name}}</label> <input ng-if="prep.type == \'str\'" ng-model="newEmb.preprocessing[prep.name]" ng-init="newEmb.preprocessing[prep.name] = prep.default"> <input ng-if="prep.type == \'float\' || prep.type == \'int\'" type="number" ng-model="newEmb.preprocessing[prep.name]" ng-init="newEmb.preprocessing[prep.name] = prep.default"> <md-select ng-if="prep.type == \'options\'" ng-model="newEmb.preprocessing[prep.name]" ng-init="newEmb.preprocessing[prep.name] = prep.default"> <md-option ng-repeat="opt in prep.values" value="{{opt.name}}"> {{opt.name}} </md-option> </md-select> <md-tooltip md-direction="top">{{prep.description}}</md-tooltip> </md-input-container> </div> </form> </div> </md-dialog-content> <div class="md-actions" layout-align="space-between center" layout="row"> <span ng-show="showErrors" class="error-message" flex>There was an error creating the embedding.</span> <div layout="row" layout-align="end center" flex> <md-button md-autofocus ng-click="create()">Create</md-button> </div> </div> </md-dialog>'),a.put("views/embeddings.html",'<div class="tab-container"> <div layout="row"> <span flex></span> <md-button id="new-embedding-btn" class="md-fab md-mini" aria-label="New embedding" ng-click="newEmbeddingDialog($event)"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-plus"></md-icon> <md-tooltip md-direction="left">New Embedding</md-tooltip> </md-button> </div> <md-card class="nabu-card" ng-repeat="embedding in embeddings" ui-sref="initial.tabs.embeddings-detail({embeddingId: embedding.id})"> <md-card-content> <div class="md-title" layout="row" layout-wrap> <p>{{embedding.name}}</p> <span flex></span> <div ng-class="embedding.status | lowercase"> <md-tooltip md-direction="left">{{embedding.status | titlecase}}</md-tooltip> </div> </div> <p>{{embedding.description}}</p> </md-card-content> <div class="md-actions" layout="row" layout-align="end center"> <md-button>{{embedding.model}}</md-button> </div> </md-card> </div>'),a.put("views/main.html",'<md-toolbar> <div class="md-toolbar-tools"> <h2> <span class="logo">Nabu</span> </h2> </div> </md-toolbar> <ui-view></ui-view>'),a.put("views/tabs.html",'<md-tabs md-center-tabs md-dynamic-height md-stretch-tabs="always" md-swipe-content md-selected="selectedIndex"> <md-tab label="Dashboard" ng-click="changeTab(\'dashboard\')"> <md-content> <div ui-view="dashboard"></div> </md-content> </md-tab> <md-tab label="Corpus" ng-click="changeTab(\'corpus\')"> <md-content> <div ui-view="corpusSearch"></div> </md-content> </md-tab> <md-tab label="Embeddings" ng-click="changeTab(\'embeddings\')"> <md-content> <div ui-view="embeddings"></div> <div ui-view="embedding-detail"></div> </md-content> </md-tab> <md-tab label="Tests" ng-click="changeTab(\'tests\')"> <md-content> <div ui-view="tests"></div> <div ui-view="test-detail"></div> </md-content> </md-tab> </md-tabs>'),a.put("views/test-detail.html",'<div layout-padding class="tab-container"> <div layout-padding layout="row"> <div layout="column"> <small class="section-header"> <a ui-sref="initial.tabs.tests">Tests</a> > <b>{{testSet.name}}</b> </small> <div layout="row" class="emb-detail-name"> <p>{{testSet.type | uppercase}}</p> </div> </div> <span flex></span> <md-fab-speed-dial md-direction="left" class="md-scale"> <md-fab-trigger> <md-button aria-label="menu" class="md-fab"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-bars"></md-icon> </md-button> </md-fab-trigger> <md-fab-actions> <md-button class="md-fab md-mini" aria-label="Download test set file" href="{{testSet.download_link}}" download> <md-icon class="fab-btn-icon" md-font-icon="fa fa-download"></md-icon> <md-tooltip md-direction="top">Download Test Set File</md-tooltip> </md-button> <md-button class="md-fab md-mini" aria-label="Delete test set" ng-click="deleteTestSet()"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-trash-o"></md-icon> <md-tooltip md-direction="top">Delete Test Set</md-tooltip> </md-button> </md-fab-actions> </md-fab-speed-dial> </div> <div layout-padding layout="row" layout-sm="column"> <md-input-container flex="40" flex-sm="90"> <label>Name</label> <textarea ng-blur="updateTestSet()" ng-model="testSet.name" columns="1"></textarea> </md-input-container> <span flex="15"></span> <md-input-container flex="40" flex-sm="90"> <label>Description</label> <textarea ng-blur="updateTestSet()" ng-model="testSet.description" columns="1"></textarea> </md-input-container> </div> <div layout-padding layout="row"> <h4>Example</h4> </div> <div layout-padding layout="row"> <div ng-bind="testSet.sample_entry" class="quote-text"></div> </div> <div ng-show="evaluationResults.length > 0" layout="row" flex> <md-data-table-container flex> <div layout="row" layout-align="center center"> <span layout-padding class="md-label-sim">Embeddings</span> <span flex></span> <md-button class="md-fab md-mini" aria-label="New Embedding Test" ng-click="newEmbeddingTestDialog($event)"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-plus"></md-icon> <md-tooltip md-direction="left">New Embedding Test</md-tooltip> </md-button> </div> <table layout-padding md-data-table md-progress="deferred" class="corpus-search-results"> <thead md-order="evaluation.order" md-trigger="onOrderChange"> <tr> <th name="Date" order-by="creation_date"></th> <th name="Embedding Description" order-by="embedding_id"></th> <th name="Embedding Model" order-by="embedding_id"></th> <th name="Accuracy" order-by="accuracy" md-order-by="accuracy"></th> <th name="Details"></th> </tr> </thead> <tbody> <tr md-auto-select ng-repeat="result in evaluationResults | orderBy: evaluation.order"> <td>{{result.creation_date}}</td> <td> <a ui-sref="initial.tabs.embeddings-detail({embeddingId: result.embedding_id})"> {{embeddings[result.embedding_id].description}}</a></td>  <td>{{embeddings[result.embedding_id].model}}</td> <td>{{result.accuracy | percentage}}</td> <td> <a ng-click="testResultDialog($event, result.embedding_id)" href=""> <i class="fa fa-eye fa-2x"></i> </a> </td> </tr> </tbody> </table> </md-data-table-container> </div> </div>'),
a.put("views/test-embedding-new.html",'<md-dialog flex="85" class="nabu-dialog" aria-label="Create new test for an embedding" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>Create new test for an embedding</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <i aria-label="Close" class="fa fa-close"></i> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <p>Please select the embedding you want to test with <i>{{test.name}}</i>.</p> <form name="newEmbeddingTestForm"> <div layout="row" layout-sm="column"> <md-input-container flex="80"> <label>Embedding</label> <md-select ng-model="newTest.embeddingId"> <md-option ng-repeat="emb in embeddings" ng-value="{{emb.id}}"> {{emb.name}} </md-option> </md-select> </md-input-container> </div> </form> </div> </md-dialog-content> <div class="md-actions" layout-align="space-between center" layout="row"> <span ng-show="showErrors" class="error-message" flex>There was an error creating the test.</span> <div layout="row" layout-align="end center" flex> <md-button md-autofocus ng-click="create()">Create</md-button> </div> </div> </md-dialog>'),a.put("views/test-new.html",'<md-dialog flex="85" class="nabu-dialog" aria-label="Create new test set" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>Create new test set</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <i aria-label="Close" class="fa fa-close"></i> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <form name="newTestSetForm"> <div layout="row" layout-sm="column"> <md-input-container flex="35" flex-sm="100"> <label>Name</label> <input ng-model="newTestSet.name"> </md-input-container> <md-input-container flex="65" flex-sm="100"> <label>Description</label> <textarea ng-model="newTestSet.description" columns="1"></textarea> </md-input-container> </div> <div layout="row" layout-sm="column"> <md-input-container flex="35" flex-sm="100"> <label>Type</label> <input ng-model="newTestSet.type"> </md-input-container> <md-input-container flex="65" flex-sm="100"> <choose-file-button> <md-button aria-label="Upload test set file" class="md-fab md-mini"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-cloud-upload"></md-icon> <md-tooltip md-direction="right">Select test set file</md-tooltip> </md-button> <input choose-file-button="uploadFile" type="file"> <span ng-bind="uploadFileName"></span> </choose-file-button> </md-input-container> </div> </form> </div> </md-dialog-content> <div class="md-actions" layout-align="space-between center" layout="row"> <span ng-show="showErrors" class="error-message" flex>There was an error creating the test set.</span> <div layout="row" layout-align="end center" flex> <md-button md-autofocus ng-click="create()">Create</md-button> </div> </div> </md-dialog>'),a.put("views/test-result-dialog.html",'<md-dialog class="test-result-dialog" aria-label="Test result details" ng-cloak> <md-toolbar> <div class="md-toolbar-tools"> <h2>Test result details</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel()"> <i aria-label="Close" class="fa fa-close"></i> </md-button> </div> </md-toolbar> <md-dialog-content> <div class="md-dialog-content"> <div layout="row"> <div flex> <h5>Test set: <i>{{test.name}}</i></h5> <h5>Embedding: <i>{{embedding.description}}</i></h5> </div> <div flex> <h5>Date: <i>{{resultData.creation_date}}</i></h5> <h5>Accuracy: <i>{{resultData.accuracy | percentage}}</i></h5> </div> </div> <br> <md-data-table-container flex> <table layout-padding md-data-table md-progress="deferred"> <tbody> <tr> <td>Missing</td> <td>{{resultData.extended.missing}}</td> </tr> <tr> <td>Total</td> <td>{{resultData.extended.total}}</td> </tr> <tr> <td>Top 10 (add)</td> <td>{{resultData.extended.top10_add}}</td> </tr> <tr> <td>Top 10 (mul)</td> <td>{{resultData.extended.top10_mul}}</td> </tr> <tr> <td>Top 1 (add)</td> <td>{{resultData.extended.top1_add}}</td> </tr> <tr> <td>Top 1 (mul)</td> <td>{{resultData.extended.top1_mul}}</td> </tr> <tr> <td>Top 5 (add)</td> <td>{{resultData.extended.top5_add}}</td> </tr> <tr> <td>Top 5 (mul)</td> <td>{{resultData.extended.top5_mul}}</td> </tr> </tbody> </table> </md-data-table-container> </div> </md-dialog-content> </md-dialog>'),a.put("views/tests.html",'<div class="tab-container"> <div layout="row"> <span flex></span> <md-button class="md-fab md-mini" aria-label="New Test set" ng-click="newTestSetDialog($event)"> <md-icon class="fab-btn-icon" md-font-icon="fa fa-plus"></md-icon> <md-tooltip md-direction="left">New Test set</md-tooltip> </md-button> </div> <md-card class="nabu-card" ng-repeat="testcase in tests" ui-sref="initial.tabs.tests-detail({testId: testcase.id})"> <md-card-content> <div class="md-title" layout="row" layout-wrap> <p>{{testcase.name}}</p> <span flex></span> <div ng-class="testcase.status | lowercase"><small>#{{testcase.id}}</small></div> </div> <p>{{testcase.description}}</p> </md-card-content> <div class="md-actions" layout="row" layout-align="end center"> <md-button>{{testcase.type}}</md-button> </div> </md-card> </div>')}]);